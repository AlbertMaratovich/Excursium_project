{"uid":"47ed545d1c5b3a02","name":"Оформление экскурсии","fullName":"tests.test_excursium.TestUserCases#test_order_excursion","historyId":"8dbe8db0514bd0080803b2e3e65bae34","time":{"start":1755347683781,"stop":1755347703673,"duration":19892},"description":"Переход с главной страницы к экскурсиям с дальнейшим оформлением одной из них (юзер-сценарий)","descriptionHtml":"<p>Переход с главной страницы к экскурсиям с дальнейшим оформлением одной из них (юзер-сценарий)</p>\n","status":"broken","statusMessage":"selenium.common.exceptions.TimeoutException: Message:","statusTrace":"self = <test_excursium.TestUserCases object at 0x7f78f4180410>\ndriver = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"ca557317c79b8af8f3cb8406e2ee98eb\")>\n\n    @allure.title(\"Оформление экскурсии\")\n    @allure.severity(\"Critical\")\n    @pytest.mark.user_case\n    def test_order_excursion(self, driver):\n        \"\"\"Переход с главной страницы к экскурсиям с дальнейшим оформлением одной из них (юзер-сценарий)\"\"\"\n        excursion_page = ExcursionPage(driver)\n        main_page = MainPage(driver)\n    \n        with allure.step(\"Открываем страницу\"):\n            driver.get(config.base_url)\n    \n        with allure.step(\"Переходим на страницу с экскурсиями\"):\n            driver.find_element(*main_page.all_excursion_btn).click()\n    \n        with allure.step(\"Переходим на страницу первой экскурсии списка\"):\n            first_excursion = main_page.excursions()[0]\n            first_excursion.click()\n    \n        # change the handle\n        excursion_page.move_last_handle()\n        page_url = driver.current_url\n    \n        # scroll to order button and click\n        order_button = driver.find_element(*excursion_page.order_button)\n        excursion_page.scroll_to(order_button)\n    \n        with allure.step(\"Кликаем на кнопку заказа\"):\n            order_button.click()\n    \n        with allure.step(\"Ждем и проверяем открытие окна\"):\n            order_window = driver.find_element(*excursion_page.order_window)\n            main_page.wait.until(lambda x: main_page.is_visible(order_window))\n    \n        with (allure.step(\"Заполняем поля корректными данными\")):\n            date_field = driver.find_element(*excursion_page.date_field)\n            main_page.wait.until(lambda x: main_page.is_clickable(date_field))\n            date_field.click()\n            month_window = driver.find_element(\"xpath\", \"//div[@class='flatpickr-innerContainer']\")\n>           main_page.wait.until(lambda x: main_page.is_visible(month_window))\n\ntests/test_excursium.py:77: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <selenium.webdriver.support.wait.WebDriverWait (session=\"ca557317c79b8af8f3cb8406e2ee98eb\")>\nmethod = <function TestUserCases.test_order_excursion.<locals>.<lambda> at 0x7f78f4143420>\nmessage = ''\n\n    def until(self, method: Callable[[D], Union[Literal[False], T]], message: str = \"\") -> T:\n        \"\"\"Wait until the method returns a value that is not False.\n    \n        Calls the method provided with the driver as an argument until the\n        return value does not evaluate to ``False``.\n    \n        Parameters:\n        -----------\n        method: callable(WebDriver)\n            - A callable object that takes a WebDriver instance as an argument.\n    \n        message: str\n            - Optional message for :exc:`TimeoutException`\n    \n        Return:\n        -------\n        object: T\n            - The result of the last call to `method`\n    \n        Raises:\n        -------\n        TimeoutException\n            - If 'method' does not return a truthy value within the WebDriverWait\n            object's timeout\n    \n        Example:\n        --------\n        >>> from selenium.webdriver.common.by import By\n        >>> from selenium.webdriver.support.ui import WebDriverWait\n        >>> from selenium.webdriver.support import expected_conditions as EC\n    \n        # Wait until an element is visible on the page\n        >>> wait = WebDriverWait(driver, 10)\n        >>> element = wait.until(EC.visibility_of_element_located((By.ID, \"exampleId\")))\n        >>> print(element.text)\n        \"\"\"\n        screen = None\n        stacktrace = None\n    \n        end_time = time.monotonic() + self._timeout\n        while True:\n            try:\n                value = method(self._driver)\n                if value:\n                    return value\n            except self._ignored_exceptions as exc:\n                screen = getattr(exc, \"screen\", None)\n                stacktrace = getattr(exc, \"stacktrace\", None)\n            if time.monotonic() > end_time:\n                break\n            time.sleep(self._poll)\n>       raise TimeoutException(message, screen, stacktrace)\nE       selenium.common.exceptions.TimeoutException: Message:\n\n/usr/local/lib/python3.13/site-packages/selenium/webdriver/support/wait.py:138: TimeoutException","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"driver","time":{"start":1755347683519,"stop":1755347683781,"duration":262},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Переход с главной страницы к экскурсиям с дальнейшим оформлением одной из них (юзер-сценарий)","status":"broken","statusMessage":"selenium.common.exceptions.TimeoutException: Message:","statusTrace":"self = <test_excursium.TestUserCases object at 0x7f78f4180410>\ndriver = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"ca557317c79b8af8f3cb8406e2ee98eb\")>\n\n    @allure.title(\"Оформление экскурсии\")\n    @allure.severity(\"Critical\")\n    @pytest.mark.user_case\n    def test_order_excursion(self, driver):\n        \"\"\"Переход с главной страницы к экскурсиям с дальнейшим оформлением одной из них (юзер-сценарий)\"\"\"\n        excursion_page = ExcursionPage(driver)\n        main_page = MainPage(driver)\n    \n        with allure.step(\"Открываем страницу\"):\n            driver.get(config.base_url)\n    \n        with allure.step(\"Переходим на страницу с экскурсиями\"):\n            driver.find_element(*main_page.all_excursion_btn).click()\n    \n        with allure.step(\"Переходим на страницу первой экскурсии списка\"):\n            first_excursion = main_page.excursions()[0]\n            first_excursion.click()\n    \n        # change the handle\n        excursion_page.move_last_handle()\n        page_url = driver.current_url\n    \n        # scroll to order button and click\n        order_button = driver.find_element(*excursion_page.order_button)\n        excursion_page.scroll_to(order_button)\n    \n        with allure.step(\"Кликаем на кнопку заказа\"):\n            order_button.click()\n    \n        with allure.step(\"Ждем и проверяем открытие окна\"):\n            order_window = driver.find_element(*excursion_page.order_window)\n            main_page.wait.until(lambda x: main_page.is_visible(order_window))\n    \n        with (allure.step(\"Заполняем поля корректными данными\")):\n            date_field = driver.find_element(*excursion_page.date_field)\n            main_page.wait.until(lambda x: main_page.is_clickable(date_field))\n            date_field.click()\n            month_window = driver.find_element(\"xpath\", \"//div[@class='flatpickr-innerContainer']\")\n>           main_page.wait.until(lambda x: main_page.is_visible(month_window))\n\ntests/test_excursium.py:77: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <selenium.webdriver.support.wait.WebDriverWait (session=\"ca557317c79b8af8f3cb8406e2ee98eb\")>\nmethod = <function TestUserCases.test_order_excursion.<locals>.<lambda> at 0x7f78f4143420>\nmessage = ''\n\n    def until(self, method: Callable[[D], Union[Literal[False], T]], message: str = \"\") -> T:\n        \"\"\"Wait until the method returns a value that is not False.\n    \n        Calls the method provided with the driver as an argument until the\n        return value does not evaluate to ``False``.\n    \n        Parameters:\n        -----------\n        method: callable(WebDriver)\n            - A callable object that takes a WebDriver instance as an argument.\n    \n        message: str\n            - Optional message for :exc:`TimeoutException`\n    \n        Return:\n        -------\n        object: T\n            - The result of the last call to `method`\n    \n        Raises:\n        -------\n        TimeoutException\n            - If 'method' does not return a truthy value within the WebDriverWait\n            object's timeout\n    \n        Example:\n        --------\n        >>> from selenium.webdriver.common.by import By\n        >>> from selenium.webdriver.support.ui import WebDriverWait\n        >>> from selenium.webdriver.support import expected_conditions as EC\n    \n        # Wait until an element is visible on the page\n        >>> wait = WebDriverWait(driver, 10)\n        >>> element = wait.until(EC.visibility_of_element_located((By.ID, \"exampleId\")))\n        >>> print(element.text)\n        \"\"\"\n        screen = None\n        stacktrace = None\n    \n        end_time = time.monotonic() + self._timeout\n        while True:\n            try:\n                value = method(self._driver)\n                if value:\n                    return value\n            except self._ignored_exceptions as exc:\n                screen = getattr(exc, \"screen\", None)\n                stacktrace = getattr(exc, \"stacktrace\", None)\n            if time.monotonic() > end_time:\n                break\n            time.sleep(self._poll)\n>       raise TimeoutException(message, screen, stacktrace)\nE       selenium.common.exceptions.TimeoutException: Message:\n\n/usr/local/lib/python3.13/site-packages/selenium/webdriver/support/wait.py:138: TimeoutException","steps":[{"name":"Открываем страницу","time":{"start":1755347683781,"stop":1755347685510,"duration":1729},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Переходим на страницу с экскурсиями","time":{"start":1755347685510,"stop":1755347688871,"duration":3361},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Переходим на страницу первой экскурсии списка","time":{"start":1755347688871,"stop":1755347688942,"duration":71},"status":"passed","steps":[{"name":"Получаем список экскурсий","time":{"start":1755347688871,"stop":1755347688886,"duration":15},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Переходим на открытую вкладку","time":{"start":1755347688942,"stop":1755347688953,"duration":11},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Скроллим до элемента","time":{"start":1755347692819,"stop":1755347692824,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Кликаем на кнопку заказа","time":{"start":1755347692824,"stop":1755347692911,"duration":87},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ждем и проверяем открытие окна","time":{"start":1755347692911,"stop":1755347693473,"duration":562},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Заполняем поля корректными данными","time":{"start":1755347693473,"stop":1755347703672,"duration":10199},"status":"broken","statusMessage":"selenium.common.exceptions.TimeoutException: Message: \n\n","statusTrace":"  File \"/app/tests/test_excursium.py\", line 77, in test_order_excursion\n    main_page.wait.until(lambda x: main_page.is_visible(month_window))\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.13/site-packages/selenium/webdriver/support/wait.py\", line 138, in until\n    raise TimeoutException(message, screen, stacktrace)\n","steps":[{"name":"Проверяем кликабельность веб элемента","time":{"start":1755347693480,"stop":1755347693500,"duration":20},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"f3ca5211e1f2b4c6","name":"Скриншот при падении","source":"f3ca5211e1f2b4c6.png","type":"image/png","size":241327}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":10,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"driver::0","time":{"start":1755347704057,"stop":1755347704123,"duration":66},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"severity","value":"Critical"},{"name":"feature","value":"Пользовательские сценарии"},{"name":"tag","value":"user_case"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_excursium"},{"name":"subSuite","value":"TestUserCases"},{"name":"host","value":"9b0c643dc5fd"},{"name":"thread","value":"19-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_excursium"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":31,"skipped":0,"passed":51,"unknown":0,"total":82},"items":[{"uid":"8095c72679dbb6bc","status":"passed","time":{"start":1755005179766,"stop":1755005185466,"duration":5700}},{"uid":"855711def39d61b4","status":"passed","time":{"start":1754650323384,"stop":1754650336113,"duration":12729}},{"uid":"ac1bb1ad57dfd1fe","status":"passed","time":{"start":1753793838847,"stop":1753793849825,"duration":10978}},{"uid":"3cf9ebf766e5b554","status":"passed","time":{"start":1753695298247,"stop":1753695305552,"duration":7305}},{"uid":"a21afd92e1279ae8","status":"passed","time":{"start":1753679148732,"stop":1753679156477,"duration":7745}},{"uid":"14ba771da6f5ab26","status":"passed","time":{"start":1753676285325,"stop":1753676291624,"duration":6299}},{"uid":"12725c35451ebdcd","status":"passed","time":{"start":1753627461923,"stop":1753627467654,"duration":5731}},{"uid":"77c22213df0f1bdf","status":"passed","time":{"start":1753626393284,"stop":1753626400059,"duration":6775}},{"uid":"28bbcb81d20b2e3a","status":"passed","time":{"start":1753623090123,"stop":1753623098455,"duration":8332}},{"uid":"f5202f7f08a5a0cf","status":"passed","time":{"start":1753622314352,"stop":1753622321816,"duration":7464}},{"uid":"bdedada0b490981f","status":"broken","statusDetails":"IndexError: list index out of range","time":{"start":1753621267550,"stop":1753621283348,"duration":15798}},{"uid":"eedf402ef83717d0","status":"passed","time":{"start":1753620246199,"stop":1753620253193,"duration":6994}},{"uid":"b6b933ca283f7a10","status":"passed","time":{"start":1753619483300,"stop":1753619490076,"duration":6776}},{"uid":"83ef13cfc9b14477","status":"passed","time":{"start":1753617712671,"stop":1753617718972,"duration":6301}},{"uid":"d1db9f66c9440cc6","status":"broken","statusDetails":"selenium.common.exceptions.TimeoutException: Message:","time":{"start":1753617291857,"stop":1753617308099,"duration":16242}},{"uid":"e3f46dbdd0062946","status":"passed","time":{"start":1753617153106,"stop":1753617159643,"duration":6537}},{"uid":"5071525d14c71977","status":"passed","time":{"start":1753616922712,"stop":1753616928802,"duration":6090}},{"uid":"5a3faeec1e8ec0da","status":"passed","time":{"start":1753616701568,"stop":1753616708506,"duration":6938}},{"uid":"cca6dfcac1fa9edb","status":"passed","time":{"start":1753610803248,"stop":1753610810925,"duration":7677}},{"uid":"7cb9ad0374118e1c","status":"passed","time":{"start":1753607045719,"stop":1753607053106,"duration":7387}}]},"tags":["user_case"]},"source":"47ed545d1c5b3a02.json","parameterValues":[]}